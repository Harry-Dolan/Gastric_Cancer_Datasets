---
title: "GastricCancer"
author: "Michaela Hughes"
date: "1/11/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}

# loading dplyr and ggplot2
library(dplyr)
library(ggplot2)

# makes the output wider
options(width=80)

```

# Looking at the clinical data 
```{r}
# clicked on the data sets which magically moved them into the environment so should work....? stay tuned....

# list the objects in the environment 
ls()

# look at the class of each object, should be a data frame and matrix for each dataset
class(gse62254_clinDat)
class(gse62254_expDat)
class(tcga_clinDat)
class(tcga_expDat)

# dimensions of the objects
# dim() gives back the number of rows and columns for the object 
dim(gse62254_clinDat)
dim(gse62254_expDat)
dim(tcga_clinDat)
dim(tcga_expDat)

# looking at the variable names 
names(gse62254_clinDat)
names(tcga_clinDat)

```
What each variable name is: 

-   dfsEvent: Disease Free Survival Event (0,1)
-   dfsTime: Time of Disease Free Survival Event (months)
-   lc: Lauren Classification
-   molSub: Molecular Subtype (Cristescu et al)
-   stage: tumour stage
-   region: anatomic region of tumour
-   gender: patient gender
-   ageCat: patient age category


```{r}

# what the clinical data looks like 
# head () shows the first few rows of data 
head(gse62254_clinDat)
head(tcga_clinDat)

# want to add in a patient ID variable
# mutate () is the command for adding new variables, transmute() gets rid of existing variables
# takes the clinical data, then adds in a variable called PatID (patient ID's) which is the column names from the expression data object (can do because the samples are in the same order as the expression data)
gse62254_clinDat = gse62254_clinDat %>% mutate(., PatID = colnames(gse62254_expDat))

# looking at the first few rows again to make sure the patient ID's were added 
head(gse62254_clinDat)

```


## Looking at the expression data
```{r}
# to show the first five columns and rows of the expression data 
# the rows are the gene names, the columns are the different patient tumours (patient ID's)
gse62254_expDat[1:5,1:5]

```


## Looking at the Lauren Classification of the tumours 
```{r}
# making a table of the Lauren class data 
table(gse62254_clinDat$lc)

# attach the clinical data to make the variables more accessible?
attach(gse62254_clinDat)
table(lc)

# table of lauren class vs molecular subtype 
table(lc,molSub)
```




```{r}

# getting the information out for just the androgen receptor (AR) gene 
ar_data = gse62254_expDat[rownames(gse62254_expDat) == "AR"]

# making a histogram of the AR data 
ar_data %>% as.data.frame() %>%
  ggplot(aes(x=.)) +
  geom_histogram() +
  ggtitle("Androgen receptor (AR) expression") +
  xlab("Log2 expression")



```




```{r}

# making a boxplot of AR expression vs molecular subtype
cbind(ar_data, as.factor(molSub)) %>% as.data.frame() %>%
  ggplot(aes(x=molSub, y=ar_data, group=molSub, colour=molSub)) +
  geom_boxplot() +
  ggtitle("Androgen receptor (AR) expression vs molecular subtype") +
  xlab("Molecular subtype") +
  ylab("Log2 expression")

```


Differential expression analysis according to Lauren Classification 

```{r}

# lauren classification has 3 groups
table(lc)

# want to remove the mixed groups
mixed = which (lc=="Mixed")
mixed

# take out the indexes for the mixed samples using the minus sign 
lc[-mixed] %>% table()

# can convert 'lc' to a vector to remove the entire mixed class so it doesn't just have a 0 there 
lc[-mixed] %>% as.vector() %>% table()

# remove the mixed from the data for analysis
lc_nonmixed = lc[-mixed] %>% as.vector()
gse62254_expDat_nonmixed = gse62254_expDat[,-mixed]

``` 


Setup for limma analysis 

```{r}

# load the limma library
library(limma)

# make a design matrix from the data without the mixed samples 
design = model.matrix(~lc_nonmixed)
head(design)

# the second column of the design matrix should match the lauren class (no mixed) table from above 
table(design[,2])

``` 




```{r}




``` 




```{r}




``` 




```{r}




``` 



```{r}




``` 



